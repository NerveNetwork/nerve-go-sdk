/*
 * MIT License
 * Copyright (c) 2019-2020 niels.wang
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

package eckey

import (
	"encoding/hex"
	"github.com/niels1286/nuls-go-sdk/utils/assert"
	"testing"
)

func TestNewEcKey(t *testing.T) {
	t.Run("Basic test.", func(t *testing.T) {
		ecKey, _ := NewEcKey()

		priHex := ecKey.GetPriKeyHex()

		pubHex := ecKey.GetPubKeyHex(false)

		commpressedPubKey := ecKey.GetPubKeyHex(true)

		assert.NotNil(t, priHex, "")
		assert.NotNil(t, pubHex, "")
		assert.NotNil(t, commpressedPubKey, "")
		//fmt.Println(priHex)
		//fmt.Println(pubHex)
		//fmt.Println(commpressedPubKey)
	})
	cases := []eckeyCase{eckeyCase{"eebbb62294ab36f1336626074f1e81482ee17700f10e11a9875c76bd31d0a07f", "03182be87cd707c5965caab6ec808d8587260e1dae8d21a880f1ef584938725a34"},
		eckeyCase{"1ed08cc206d0a91f1cdd8913337bcd1ecd05308a4d18727aea6346ade78e863e", "03c29580ae7eba733e238ce9d6600ada110f4b83e9ded355d3796984a38a8a9690"},
		eckeyCase{"680be777d376e295a5e4cf81952f81de475f5c1a17dc22f79152460d5cc6b3c0", "02fe662c92d094d6d287cf42240a4ff6684775610f00e376041b1e5fda34f383b4"},
		eckeyCase{"5dd7e20845b5e1ff9805223bee5316f3457cbfb6538188dc9626ba20f58aa9f5", "029d4e5860752089f8bd92aa98058e8fa5d8633d58653417f9977a6e23d7271f7d"},
		eckeyCase{"1295c6f76978540d72cf1468a26311d21866d73c12e0375a20cdb81a51617316", "026e158e80c350dd27f01f93030fce0294fe8d1f97e6345d536270289c7bf8affb"},
		eckeyCase{"6d2d3e4ccea9767f2a04777788e3a118d890e9051c5529b141fcba3c63ae20cc", "02f3a8f536c47caa7c50dc98454fcd8405d40606c15a38e9bc633ab061beac5523"},
		eckeyCase{"93ba05ec77258b58139b0f1f56099760a6f2d559989d0f840d7e98b0a79f979e", "02c5df80aa8bda6e8e092d00d5ea194637946a751ece6c8fe70236404dd258e23d"},
		eckeyCase{"c8c6e57f78a2df72053f9773bf14cc17b0c26085d5c28c9fc24cb01bbd25e7d9", "021b45f07b4622afa489173249e4d1610dc65fcb2456394617102eddd05a7a0c1c"},
		eckeyCase{"9e26827d4b01c9ef1229286aee113c0dcc180e898ca8be488f2989cea445d600", "02e6035ee388cda1c28bf54ba1926d8ddeefa603382dc6cf20b31c3cd88cf4fe36"},
		eckeyCase{"4c04cfbb6dbfce896098fd51fc0983f109ca351efc280bd163c12635b9535a93", "02f322e62d2cf1b6014c3f25652f8cad057667b446bebdfa90f0039502a9356151"},
		eckeyCase{"ccf6826d330fb3bf57929f9cfce699a92d07248dec9073c8c5419fd7ab2b7e24", "0202977f0b00a3d25d27c1757d40ef6343c06323f8f74c2284b3ad9941ab01789b"},
		eckeyCase{"7af069e5b315b331e536437e7e3ca442b10bd19b76b1163d0c9cbe2820d012ae", "025428014cf428fd7160439d31cbae50799f42022ae12d0ccbdc0267f85e0cb46f"}}

	t.Run("test compatibility", func(t *testing.T) {
		for _, item := range cases {
			bytes, err := hex.DecodeString(item.prikey)
			if err != nil {
				t.Fatalf(err.Error())
			}
			_eckey, err := FromPriKeyBytes(bytes)
			if err != nil {
				t.Fatalf(err.Error())
			}
			assert.IsEquals(t, _eckey.GetPriKeyHex(), item.prikey)
			assert.IsEquals(t, _eckey.GetPubKeyHex(true), item.pubkey)
		}
	})

	t.Run("test sign and verify", func(t *testing.T) {
		priHex := "eebbb62294ab36f1336626074f1e81482ee17700f10e11a9875c76bd31d0a07f"
		data, err := hex.DecodeString("025428014cf428fd7160439d31cbae50799f42022ae12d0ccbdc0267f85e0cb46f")
		assert.IsNil(t, err, "hex-decode")
		priBytes, _ := hex.DecodeString(priHex)
		eckey, err := FromPriKeyBytes(priBytes)
		assert.IsNil(t, err, "FromPriKey")

		result, err := eckey.Sign(data)
		assert.IsNil(t, err, "sign err")
		_eckey, err := FromPubKeyBytes(eckey.GetPubKeyBytes(true))
		assert.IsNil(t, err, "FromPubKey")
		val := _eckey.Verify(data, result)
		if !val {
			t.Fatalf("Verify signature failed.")
		}
	})

	sigCases := []signatureCase{signatureCase{"0236daf54c038b0919bcf05ee55f304147806d60ff884fc56e96df1956f3b599b9", "f4c6cab2e99b91b17830fb3412369decf4fcc1c2fa72b05e8be88fe35c9af8c5", "304402203602e95ee1ffa2114e506bfea85c2b07ab206fc45a47152ca7af61b3c996065202206ec1eee9d3f8aaa45baaa1e9f67c82943831e5689bc5f4bdff56cea04dbb0879"},
		signatureCase{"02eb5d0c82c1cc9c2a305052225c28d311b009ebf6fba8a2826a5196324aa8fbfc", "03d8df1985317cd9b69d6b145f6332110943cfcec69055b6b6f8a6226c72a3b4", "3045022100fde5b462234f346fba7abc6a1a794833ec9b6f80f64cda607875db9544dfa0c702203052a2a652ccd52e34c11f9633d8dae3386d064c8edf37d1f2fc9eb63f870e3e"},
		signatureCase{"033ebe33ad0015686a92fde9caf38045679cc7605bc2a8113288f361409f44edca", "125faa3b08b25a48befe4dd8f3e2fb1962f74d600ead7df5d1e64bc07a7cf1ae", "3045022100a9f4cd0f856c05ea6c3479a4fcddc2ec65b1ae57b0b68ffdc812317cc14e360f02205b4b58a3bebc0e9523915729d3044b3dd961273520ae62a4fa87bf1a0efc4bc9"},
		signatureCase{"020b7acc77d5b0737019897177245c1f2e6d6e038c60c34ee96c326fa8c6c54019", "7b0103a282db4c080cfe79c9576db5eca79ca69bfae7b79257a9b145508eef0e", "3044022068c8abe6af8199ede7e183e77d3637c70c9a283d9a8c86f6c053df2af7140f9d02205a772acb8df00257357b126bd283bb479794ba88083151a0265f8ef78ecd0349"},
		signatureCase{"03ff73ac592810a2077949bc84c57c34a33899631cf0c4753bcd554ac584ebb23c", "5393afa8ab06ff8f1f6a6b4d479d50b88b0ff2e76cf0cd4081b295bac1910e6c", "3044022075d8166d609ace8b2ad32b86b185dc8e8e1a2d5c303240c48463c959927e7670022035cf651c547941b72aecef32c711a44e91c9eb05302df045844af4dc296f65ca"},
		signatureCase{"039a5d1d4e5e5d2605677bf6cc21d07029d77fc0d592a67e84008d37e9dab3f444", "4e857599f6b1e7ff33df3e19abab9bd458f170951e9f9ebd62f88afe48a19b83", "30450221009133064c7529171a4c3ca7805b52709eb3aaff5169b975332709cd264585597202206929fb0664fa265ced5bbf9859c7371b61bc1d0e75deca6ec9a9fb4d884f3ea8"},
		signatureCase{"03bc57178a6ff19c5cda58e2958d41adda6447df867029936c30d69735f3fdf82c", "0a4714162a1875efeee08f45bfe2006d6a6e4eaa4c3d781fbb7a43eb61dbf34c", "30440220498302d357c20b310ab305fa04ac358752fc4a25c7a53287cd73b01c8081a4cc02203e38ebe3c60f9fe8a6ca4f3f824ad19c2f450869ea0ae03d7d61b1971263ecb0"},
		signatureCase{"03c5abb7aa9cdd10df5ff02c7a7823d35ac9300af57814b52058512b44272083eb", "31a6c8cea900d525c81f10d74356715f666d208685f4e790adaa46d435e7ee62", "3045022100ee86509a5b79b1fb9acb0b6aea966f8632f4bb395993119e4b9aadf3541d19040220182099946d6f674a91243d87cf0fa18fd7d1b6dc7421659240649fe7ad591dde"},
		signatureCase{"0329b02e53ba1f173fe8d33a776fd26699ce1de0ff8e6574bcc887ae985ca277fa", "49f473c478aad22e37866d29f6f4161b98514be39bf5b715bd06256255dd166e", "3045022100939389453b49e8436851206c123ed6c77953e33a569e948abccc008248a493390220387880f88e0854ee19b9f51367c20ae9c4497d97ac10d3a035d88e92ab17b07a"},
		signatureCase{"03e9a3cd1b0bbd7d59cd3d2c5a355925668303cfba3bdc050e6813504fef338c00", "ba739962de9b1863b63f21d4eaef7a3fc0417464308555bb561b93f27a04881a", "3045022100fcefc20bbcc83e3114d7e786e2580841a519e3a822278567cfd41fa208ea875e02200ecd9e1738f9b91a28dcddf72d1c52d7a96089d6a8f1bee3d8fa0da16058efa4"},
		signatureCase{"031bbc11cf56a8d682622be889bd105847d7cb76ac77e2f261ce03e33428659112", "aa0022bab827df355fdf15a97a14f18127e83d4aa2642990bd5a5a547f3ee2d3", "304402206ad8ee67387cb4302999601f04173b49ea3e5d44d8187c01a61eb9cb707c68c602204b010baf5d342397db8ebe27977bdf810e66beda1d07cb15e9b5b68acd99672c"},
		signatureCase{"039d06e399f2ba340bfea877fbb202aa5c044ee3767a3aef6f0a5e31be2f690df2", "a4d05ae838e2e513308d7ebdf9c501e6fcf0f05348561e6babf6f7303b802be7", "30440220556ac18f101df2e16a95940790a1d034dab9b52217886a8471d104d30d1f86e802200d6982e4cd264511c5ed91611c9b051d435bc9cf7e06cc8ede2eeea326373ddb"},
		signatureCase{"02994aafab87d398fea66e3b80397da1f199239775819858bc79d0542453276257", "76d60d93b22f7ab181e5e9ebf8c97efa1c9a99c53dd316f6067164fafea045c6", "3044022041c00918e0eb48078a76f82665be2f06c90740d7e2c80f84ca7ffdbb5ed0ca9102200fb51892d06903853d83d4a26cfa5e0d998e919aab56635bb4959006d5f5b2b2"},
		signatureCase{"02a57936295342bd70d836830a50e5eb5ec180191321ab8649d55ace65608ed6b7", "57b91681df2d4f4cbaf20fa9f505aaf523f21323e85854a3e02a548d26505190", "304402200fc2236a4b2f847cbacb0831949e40cb4f4d31a7e598868b88f567fe02c67c3802206ff7237e1c24178cad09833a87063a5ee24383b56b47613c9877d9a16ea1b764"},
		signatureCase{"021833a450887d98ba3ec7b75f0e1fd036b479286d8e406a3757cd73c81136f11b", "d06f47bc24875e28d630b0ea391b90059b4cca2092e3b13d45de819ff81ef534", "3044022042ec83538edbaa8e30b9761878868737429dee9923097cb42b8a079a984284d6022035d7429288a9b13a511caf698a93f9300c3103e46a24c11e5372b74ab9c018ec"},
		signatureCase{"03470450d683e013a5f6dd8ac3a34d04ed0fe960e35d221af039c90cd7b6e11414", "12a1139abcc6e52858d0765a51d3ed049c46712ffc2091fbee8ce3379679585f", "304402201fae44ca2386e0c3812cf8799321f3075ef6c10a01f892dcc9e202dd272aebb7022021a2647e8daaa70fcb4396496c512936bdaaf1ceaeeff3086eaf70c062acf14c"},
		signatureCase{"03fb2d58f3dddcf5f61524afcafe906ee7d94f903cc461ec6734da24f5734c222b", "a5f94aa47137e10c6c47b5f8eee6a14643f5d1abe6eec1b11bca17d15b130354", "304402203e4d20b25083c2c2baa38c23d342994f097c7bc90793decb3b3c166a6f3e49e5022044643ffa1c05a2e8fa07612f33974bf5600370637b11658d611e43464979a9e9"},
		signatureCase{"02affe0ae83199ef7c862c0b2e2bef2f51257d8c5ea4f666fa297365430e717d67", "cd08e890cbe7d6850a6f98aaeadaaa93484f5aa53d3379ae77d0327f9dffe7e1", "3045022100e331ed8958464382bf8d9ee6a140fceb02d7b933ce39da1ba9916e6211e13b7102205d05b2ad19c14b5377c1991a21b5d9ea212b3767556e171dbca6a2198e092b9a"},
		signatureCase{"038ba7260d255661a545490be96b7e8462b27955ee499698628c09637383122dc5", "f73ea4d29e1d2e2227e6e519907779ee4879cb4b6e7ed638ccaa69a18311c227", "3045022100d741adb76b9d30aa1f3ed57d21d69e684127d5cebd230ade12a3b0a60a46e417022077fd22c42d97a7f95b36ee6eaa045140541dc3d30473dcf91336c67d9e42c9d6"},
		signatureCase{"033e6f9b0974fa2f138ae83b0d6da01813edb9549bacbb3e0314d389557d339150", "c242e049291f87f3180b7f51a5f9672379c3948891c166653c3b0348832d93f7", "3045022100f7e283e9a485b9cfd6cbe04048d1adc55faa3a58fcedfcb7c186a09ef305ce3502200229cde2663f0d67a8afb0c1d9cb1b58d1492e5c4ea8ae415433e44cc0d128c0"},
		signatureCase{"02a7e3103ae4724ef4e15b1a051107aa265274d0de2d9871a15a6c6f877210e532", "1a8d7a64ed7e7781f79854c8562014e7413aa04c62f9695e6d80c9d6e154e9e7", "3044022028afeaf309c0087435d42314c7b096e347236fa53b1be599644f9fdd6aea70ae022065287d20daad5097694402b4e1864dfd40ca3c3e1cfb629a19a66e0f34e12040"},
		signatureCase{"03ec0c63ba269626f412345890ec94bbe40e8749c702c2b28d7afcacc8049eec9c", "e4807ddbd81f10f3827ab3bb75f695d53897514a3eff1766557245ddee6bf5b5", "30450221009f16cecfa90c7859fe933da2633736cd8e2cd8084ca18ceb88ed804f5fd85f0c02204a146a6f93bf63846f49c39768d42457f611592213bdeffd1847ca39cf0daf39"},
		signatureCase{"032262c398c32f6e471d7866b493e224062be4d43e161704ded8c850e9d30597c6", "b04c6b8f9c54676ed63fb0b8e673a74a8f919e438c6e0334e68b0b8adcce9f89", "3045022100f8daf4be61a64ce37338049d454d4720bb266f508961048b2f9ea674e1ad5e480220241fb41b8265b0b2d9fbc77f1ba7ae5dba2453c9e7396e0cf3aec880463bdc74"},
		signatureCase{"03c55df938022429917b1c1f495a767cc2f7b7904412c318731ef93a2b904bb116", "519fe5203590da40e02b5eeefe4eb80f284d8163be0a68caca986a530c3285b2", "304402207b3f89a1b784ce9ac5273f162bfe9c820c7c7301255b8c15832e62bfdadb8b8902202d3756392f44b21bd8658e66f8e6a9c6595c668013ba6f1228fff5a663656821"},
		signatureCase{"039628cd2445ca63a09e2e6e82c2190b74d589251a4b84d7db0b3fc4591ec50293", "cb09d6a79f75b13536d3c93b42afa02d047a9b48c75b0620b46049dd77f67ffd", "3044022024e691b9dfe027d04cadd9a9b4c76d6b410426b2a58e6a88cd67b82d364518a002201c93c0b0c6f384fe18604e8a70168498207f111f386120f1701567739a428281"},
		signatureCase{"02a7006cb181fa142976bf0628fb3f9941fd65e4c71b35b74fbf773fcc64074383", "3aa71f1a9b46c3e73546ea5b7a2690ae7b036e4cda05a3ae40991566c9f634ed", "3045022100e879fcc2fa69e99fc712d8734f826d990da27fa1208daecb9cecc33aff419bc402205e9e59841dc194d01a272d5c5498643dd99d2dde582d01123ee6611cb0d4c2b3"},
		signatureCase{"03e3576033104d7adb8bbb4746e91a1c48e23b19e43c6b8463c523162398a0912e", "288dd3a0a541c32da074460ebcd240db51bf442ac9b7cf1fe930992baeb2d5a8", "3045022100c99fbea726e320ae9d8183c769aa9b30321476532dac1a672ec539e905a89650022004d03f80308f14cb1b9297f336fbf654d635bfd18c57a041422e6cc33644f4cb"},
		signatureCase{"0316a729a009170cd7c4bce669100b4a641edda158ab34ec7bd4abfd8531eae744", "d66f67029a38b6a1fdd14508fa8ef1a0403f4e4ad60d44d72a2b907dcacfb775", "3045022100d34dca895fb4d3592578ceba7eb9ce0c1fb47f72a21057fe514d1a1008f92f2e022037fb632f10763c2f29dec42a28f2d63192c499c6efb399683d43caebcb09afe3"},
		signatureCase{"0229589877aff4e13c7800f64756073957de3b30636b6d41ed47e814aa695b4eef", "96f9ebb5876b320c719e14fb1a871c3f8e73407f271338a7362520762fcc4c60", "3045022100f0c465be3d7524821fe890633c68a77a22f432528a02d1ad2659dc2fc6af9f1e02207ea62c665626cdd339b04ad9c70dfd358b949d7a83809cf8839764841cd6b367"},
		signatureCase{"02770deeb6df3cac7ed3041b9dfebe4b601a45ba9b60ed6581f646b284eabeb0b2", "0e735580c24de4665a1c64c3bbfb79c120979aa472a74a7f35d6824932f09f53", "304402206cfb0ffcb4a080d894060c9e1b0c4e649207d598e169c26fb7ee2c035cfef3f0022077a2d6f4305bbeca9ad2afdd72b57bb2bb0f3028942afff4cc68cebb7d2a8119"},
		signatureCase{"02b7c6419990b6154f4ac77778e72d9d1e24b7632b941344a7cf09b42bdaf78a5f", "a50948749f8b2b86be82220558b4c617b458ff7011f731ff40c5dbef71fb0ac7", "3045022100f9c35ac09f9efc1a3baaaaee56c17d675309a37aaa85e81e594203b6f3861f0802201eee7b982d9d3c189827af676f4da2cadfa9a435da78a758c81514725b7c2fd3"},
		signatureCase{"02b7b857e4ef23d3e3839f43797a1265b9de6407cee8a930486307b7729a807d79", "919a54615dcbed8c7dc156c1a8237b15c44c240b0d76c8366a747b454f53e74e", "30450221009d75fb0e51020b112dda60bb867f48d4a61a46c76498bc20ca40af0e8f473d6e0220471f92a8c0693bc1c913c0a156eb6e7524afe17ce0c96bee3c7baec019b36d09"},
		signatureCase{"02b18139c9340cf8ca323068c75b321853c97224c906c0ebd6c51732311908ea49", "e18aead179fb5ff103da1f78ebb89c94e9c00f19b032c12907887afedebbe024", "3045022100a2dad446dfc4cc51f837f6ff4c63a2445aa6692e9a12a73cadc612b9b60232fd02207c010df1b5cd0890c5979320e27dfb55a0f7fd644b298ff3965517ce93c923dc"},
		signatureCase{"0286506d68d5c4886fe3520b942c86804d01817eef754be89f8fd99025d82e116d", "25e1bea299a2a72e6ce8c9a3f7b35ee0b7f5184db5143c0eb12e40b1d9a39d21", "3045022100b62ac2881fb92257d3fc9c91c59475d0a0b135820294044294363a8e1635060b02201c5968514e4bec7edcd8dec568f2adfcc488d9758651e0f54fd7bb81707c727d"},
		signatureCase{"0357337205ad6af05e2812cfbb58eb5d4e305903568a38468c139f1910a2981555", "0d5f2c910c63fae7e1fe1c6c8115c3239098f6d01f5d21b7851f245fd7c4d983", "304402207903869926e4cf0d56024fb29b5c4b02f10dbfeb454639a39b8337e0db12774802205735358e7c5a1e5e0251365ca30d6314cc10a0525e3b2a23b2af3394d203bcf5"},
		signatureCase{"023978d241b557521eb1eb4cc50c8f754a2e45e3ab769fc7470f1193503a4c72ea", "da8001f2097bd9c1273ff2adea02152c671a7019ede2bc361a77b494122f8bd7", "30450221008c5f58b011250abd1fba8b40e156c255737212eb3497f20782b4f53196fcf8b6022039a95bd68b286c3619a713a5f08c0483f9c4557a8ce63ed5ba9ed5d7c21094e2"},
		signatureCase{"0356819d5541cf872dc801335f7efad73ae9e85a7d69d788275fc9ea297c4dbff9", "2e54ffa5ab9fdcb571ce1b9b3b57d62d921af65884a551422188fa26664d2c5e", "3045022100fbb8ccf9efe62203fa92a5910fc3ec98467e64a5bcf2031fef125c71fc475f8202201a03a3d7e8c6a6ea4595c489fad17c56364d4c2ad75009977534cdcd60a1ff95"},
		signatureCase{"03f4ea069faf18aa6c4e53261716131ec62305546b6f7eddb3181567d199a7d47c", "d52e96b414e9ae3abf7e472d3b1b93a32ab0acc5429ce66792e009ec9501b967", "3045022100f3258adafae60b28af69e0ba7cd77e4ade59ba7d03225b703b88c51dd5a8a423022001a7a03bbabff24d135ef09cdab546fd0e786145295398ad52a646edc61c1ffd"},
		signatureCase{"03a7002b6c4e00cd782c761a30ee813c141d3f76e6389f604fc573027da9a87c7a", "5b067d16a079a57d4cfd145aa6be1c9ad9fbdd054090ae52c7865b04590f1c3d", "30440220384c45e3f05e67a670baf611c19a0fd7613aba57611e4e49d104a477e229a07502200c1ee19c936787116a19bf1c4dcd494af5ee0b6ca3aba6144d66e9f56df61e43"},
		signatureCase{"02c025e896d36e6b5cac456411e3bbcef315868fc3c5abcc7fab111ba3f990156f", "c14f0568b9c5079788a33aa8742d16663dbb33236db12e98f7d32c1341de7f5b", "304502210098eef6cde232da09b18defd0e61ec14fdfedb39453b9478ed3413d947910e54102202e66a5d8e9a05cb3afeeea5f54f05585c271e73fd63ff2097fec604b4f4bcfdd"},
		signatureCase{"03422be2562661d70425fdc0231a2b63cce49e723b1821082052116143131cd5ca", "f3a6534aee704483edfb0a8981c21e198baee562a70d75c6925dca5b62e847fa", "304402206cdb33961d95a882ed334e517eefd3e47f6a5ceaa653b753f60ed1cfde4a478c02202c2ee31a4857a1223e8f6eed0fed88106cac1be36ed8edb5956c5d72541c5e77"},
		signatureCase{"032ff4d4de36fd88c57d6a9201ea6ba507eacbf31e253c2fcd3334a6adc3e0777f", "185e07dcd3f225d6de8055db65fdd947e573d7a8550ce72045a2c804775b60ac", "3045022100af34b5d5c69adbff9fd0c65a082ae418d44f3d53e49d76a604bf833e6288519d022040cd7c22c7264dc4027e2a278c7692a59b8ce9e13b5759ce3cdaabf039dd299e"},
		signatureCase{"02892ea6526f4a36bcf0eadbd323eb1caf61cdf9de3bd0b2e874118779c606b486", "bd40412340819cde4eb120f3dcc5fcb31efdafbb0f603572037eeacc0599accd", "304402203bf93c7495963c1769523088c49a6df82e8b056c31ed3d794acc1139946c2424022033bcc49ac8abaa2a894f3f7b4c6d9f3bafe41c0ec5101c00dfe2ab51e1fd26b1"},
		signatureCase{"022469686c149ee64794a2a99514ade7cad21086fa167dccda1564021c907d858a", "3a23204f4d23da6cc65e6b895d395f2bdeb15fffba0a91526a78a9b8036e37ef", "30440220280e51048af0f13a44662c7bd855f679067d2641f4557fd79473a089b1df2a3702204c1bc4fc181cb5429b0c308c8c07f86b1086de115783976c10b6e9b13c844afc"},
		signatureCase{"0268eb4e832e68be2157628ef389449b57fd0664c1aa0d0befb092cb53ff478675", "f7f86791b95f45ba03d4a509ba0ab787764b6dfef1483c7abe9629859ff90711", "30450221009a26279683860c1bc9ceb49e72b2d446cc81b638975b313682e70b33ade8a300022036805bac13dab3156cc81b861e99cf172f7ccc3cbe5eb0025665e2eba7aa64fe"},
		signatureCase{"03d09d165ac7878874c97b0c2e5b97e149ec126e9e0c4059700d75fee7422201f2", "4e3a2f0333aa31a4030d6ee75ba8f2d095cfe8252f1c22a1439950ff3b79a2ac", "30440220496c47fc474e5cbadf7dd9c188532b27713b60cd4ef00e054c67e03e40e70b12022046cc18c54445fb1fb56b67cee951f3926ef3dc8e038eab91f4ade7dc0384b1c7"},
		signatureCase{"036336147cdc5a94d08ad0c0b9a2345d832c75407d4fa8d92de03575ba07d9a3d5", "779deb964371bebef66218e1dd44f9be32b66be3d9cd1025ec3005c64878fb6b", "3045022100c8c95b8ca800157adbab05d018813df399f1ac962e80c7b63fb989eac0a8a5b7022073683d5d5f0d21f7aae1eb8989619bc4a6d0d9bb6038065eb1d10cffc5e110e7"},
		signatureCase{"038810d78380fd7b295fe22f0a9657db6bb5f0c9eb3905d04c9f058925efe56ae7", "32bcbc10a11deb024bb742f5cd5838f9ee9c19b0ad27ad8a70fc74060fe764bc", "3045022100ce12aa0ec0c20075e8f73176ebdc90ec42c7cec0666b7cd238f99db5b743912d0220214c45482f3d93510605def94b441b9a41f05ef56b5361d105556cabd8f2eda0"},
		signatureCase{"02b76edc1928df3d66fd0e1a23be48be3dc66e0c253c889b8b5a369e3a17f4031c", "0af446f85d82bc7ac1a73ca71b6b7374f37e3ba6826090719d7388d410345c4b", "304402204d8d8a4d1926c249830fc9cd03297b6b188e6e117bab091a1bb2bfcc0d27235702207a573704bd381c0e23ebe2eeb4924de9f2e2a68175f84c6294240b24023a7056"},
		signatureCase{"02fb354723940158eae892018f51b1634c2ddf535be6c563c8f6ca8ff52bb24781", "f89979a8dd3e2ccf687dd9b541a8018c85a92ffd9e693e468b3207a09752019f", "30440220675812839e673b366740e80070d9f422ab7d222695e9e35a1973236b50a0cc170220181126705d08164ec7587a0e0b6404e3431c71756b9f2694d3ef4b0d796e93f1"},
		signatureCase{"02b6b1d0c11c78b0cf6d970c007b9308bf0deab34cfb99d686b5914e31a9a0d76f", "c957ba50acc90251ceb884ad7761fb25264a29f96cf47af92dd61f406851ffd5", "304402207ee19aff114a2cd149d6a1b8e88aff81623710012f54cfea8f286c30043c6ed2022019a5efdd4aea0285439445f40759cee858162cde14022c20947a7c84504d81c3"},
		signatureCase{"02cf3bd4f5ce81833b2d158585604c16b587952a153a32c484507f33de150e2070", "479367115a31ea518292e945bc043e24d5fad309da2f75e2d70968d9325800b0", "3044022064a211460966cdfca23fe53cbbc59db5118bf287fc4ded4b97256cf612562f9102202766844999f994366a587b92233f5a462a01b6bc4cb29ee4e33312b7656d090d"},
		signatureCase{"0229be8f5d9697fadc4788e8e266920cb531e8a853dab85aaa43659beb2ac6f29c", "14396b5d89687a8d69b9010c3736f870406a644373bed663d4dbacb0ad0fdef9", "30450221008742069f70f6bcae8d4b59c4d11e968b3ee350273b1115d0757c73fee86e1a7b0220242f15e759e44feffd07544c12225b9f5e88de68afe0fbd748256da9187c6d10"},
		signatureCase{"03e535995657332f6392e2a38552e9f7f65e50f859dc9eea0357796eb1edea9562", "dd6df6ef71ec01e9c55ffcf031ecc70cf4db50bd3046e927cdf57c0fb00e9053", "30450221008a41057b8db0303990ac1d653931f926f33a90d183337969484344e97f84cdf50220372b11900ad048349c39fcdb02a4574de8c0c3c5998605f2e47c3e4fd8d3842d"},
		signatureCase{"0396def87db85608d1040f9b3216184d5380df01264c2f7f4ba25aeb9002f70c62", "1812883779837cf727a68febf430f0adfb0219cb077c208716a6c9de1c606d1f", "30440220069cd23f22e1c78b90624707ce8cba810265745ed3335fec1cd49b3f87bc4788022065c9826917deb10e10e5854ef96a779cfe1e8a15f6d0acce510e3a0c003a184c"},
		signatureCase{"03e6acb6c7ae9abba14494c26355b6764c59d29578dd682b9ee447554e9038455d", "6ebe561211770dcac2d64d225d891fde9a6194ba470a10e01549e91afb1e26ad", "3044022013d055639de8d43904ac459ce66c806afe09cc45d46eb6749e154926008f785902202833675a28907fbba2fc39c82065842a52d7f429782020e35cb96064e7ddb98a"},
		signatureCase{"02cd1173dba63fb59be2cad32c0ff8aa28e0956ab684bf4b664ba2296f7575925b", "dc34f59bd8d020004c8146fe485234916a71d6174e91add07baf3939a701a2ac", "3045022100c2ea86a9d7eef0942fa069c30a0536858b9a13e2387e6c6251e8b292d48762ea02205d515e51cbf1e63bf06c78ff4d98e1f073e9592b2189f35d42497fba720e04d8"},
		signatureCase{"0365803ddc016b6081f205d901f18ee81dda8b95c93c70edf5721d01666d46468e", "9d24534ce366347c1b6f6dd229c39b042b0f945c2de5e10c410ac3c33385d96c", "304402204083ec2b805a205502046baa74399b553827ec9d97e8c507579a4b25e06a36ed022070143f8bb088190c8452407ff7719bb81560361cebc0fb6090d95ac10ea25b10"},
		signatureCase{"0266af309aa7e7430eec14e670cdc757a88625b208516320f33c4e7f41a96fa57b", "0f3077f1cfe4e1092705c2bd8436b309564ee002a7af706fa62aa17d8fe8a4d0", "3045022100bbbc3e6c79f7208826505a620cd5ba08d0a8b5bc9e323736036e636b032c140102207a84b106ba0ff5dbf3d929e4c5264d4729f65583d47ae104f310c200283b1822"},
		signatureCase{"0352b0c026748b474f51d71a92ac20c46a3e6e1b9dd802a8d91439dc45f91af188", "27354d7e428043ce09d8c9c5d8f9f21b0fbd4a23cb91eccfeab79ea960980902", "3045022100d409bd797d13bce5755fc6a6ba1be8be91c395764b39b1309978dfbb32a4153802205b34a6a0f10cdd8e42f6ed0585d3c32ea8170e52f28c9bdd8115d2835e1172c3"},
		signatureCase{"0244b99a7e0324f6f842422107ab7fdc213f6a9884a3cacac224142dc049bf9183", "3dc0a9dd81a44030aa524231e73338b5bb31043eafe64c90c56627c41dad24ce", "3045022100cdd9263bc669b67a839913d89b4928c6019ea340966e494e27382412bb772dce02206ad24423d43d16206e8d478b70fad11c9bbcab537aa393082fab0dbbc3486c49"},
		signatureCase{"0229ed56b09074b5c08a7073af8b006aa22bf5b4b6c5d3fcb0277a381400376213", "e63d1b245001e253925f1d01c109bec0eb0bd31075344f98c547ef3068148b1a", "3045022100ecee0c10bb10d677f3512c573c66ccc2c7bda4104eeefe4e51c5cb8f756fc6ef0220690581d34d8137a301fa27b5fc36e93a6ad16f51d2204ba875fe4186c02597cf"},
		signatureCase{"020826be376dacff52c909e1927ed204550ceb08056ba00a2f77ffb1b6c6ba4d3b", "a1c842b8ede50913d7454c66834cafc553cdbf2266fd2f3ffa0238c98b6018b1", "304402206702fc8e263856f8958972d8a1da72d10b4497f7f1f973683a2c17be206dfb0d022037c4ddd4711b299b418a4e40d5e6de1a2a5288c5905fe96fe0d785ecf9b7d435"},
		signatureCase{"03c81daac28237c26f29c40052a6f4580dc65b948b47fdee820b86ac4faeb1a65e", "02826c77ebb7a9e03860270cc16803c7e2266e3273bb5ce974cd2e77674b43fc", "304402204126080f84effec878b66d30cb213aef6ae76bbb9e6dd179c19f73ea2c89e43f02206b9087e5319694710e9599eb78815a56a1f9076974cdbece83828e12845aad5a"},
		signatureCase{"02f56b0722060d2392c484f473b4cecf0a772c10ad919f35d0c2f98f8275b4afb4", "293a20604adb0d5956680f2bfa872be1fc25a750ce7de4075f965688d67b508f", "3044022009649f165a353c62fb6028b40e1169deb319436aad56e53d0091604506b3a60a0220305299d08e936edd856b3b644dfdbe68e0d0ed0b20dbc0e31ed55733574e3a4c"},
		signatureCase{"0260d317fbf4998c140cd1f1e48ef2e6c38c0c9b45954a2c303c224ab9ba481cc5", "aa1b3d855952a26edb5c8570cb6ffd19b4b700188521fe69e1bf68575d0682d5", "30440220079725abd2163c0f3faa07fef1a25af3e4ad3fd5044abc3f01a1a1c5d30b0604022041e80f9c9f1adb97ab59ebb218c47549a47881e314a7afedf2138318d5c01554"},
		signatureCase{"02973c81f7d397e1ef74d7ab2b41be4c67c4744f160a61f2656f33006efb7103e0", "a74b64ae1e258095d3d800d29d2a985cbcb1cc461311cce8e0678c13d2d39083", "3045022100efed281192b981c0f706cde7fff26761320e057edf80953d8b3f17da6acc64970220495cebbce8d851ba89f4227ddff5aadfedb819ac23dab08390d9b2262c7cc548"},
		signatureCase{"02e88f50d5b076c830caea9aa54bb6ba089f29bd5c424395eeb83bc0dadfcf4bac", "ab6465b01c5326a325078e73d2430af358fa7b4e604e37b22c8770f827a2cf00", "304402201a64489e3f3fddbc28771c4e8a4fe353fcfd3a71cb864d9ca68fbd9880c1b29702207666c15a28d04e0028d7414ade4600fbb86a425912afa43e1000fa32f156a22a"},
		signatureCase{"03cf01f50b44f49b9e0e0fb8d860c5e5727d05986bde7847ad24d05e8fa9b0199d", "32af198440dd3f315b1da4cd87e127abe555820faab98769003ffbe4f58669c9", "3044022049dd865c6184953c6b22770f5d252a4e72dc0d9d717ee02041dfe580724fd0210220079cd14140f2935cba3daabc9c2d6d52a498319bc7c97a63fb6013d6f8d5c127"},
		signatureCase{"02c675f59ef13bfae1c1c7a2eb96c4a6a4b9baaa7abe0f3aa7b986e37edd001a19", "101b8ba7b913a0a1bd6e46b8b13d985abf67a0d4aebd4e7eb8a95d11e7bad910", "304402207b614d60b8b4fdd3f6482666a4d477ac3e6d6f2e5dda8eb090efa7d54067135002203d52f7fdf941cbeaaa087de8367650fe13936500f290eee1f9756c7eefa5204a"},
		signatureCase{"0303b2af74cbe8b5708f7ae244dfa8eeb7ff165ac15f1616bd2f6cfc6b3c33eb4c", "050bb06b666ad25c559647ae5b231fcf1ae5f603aec91c8e6c8dc68250a26b9d", "3045022100ec165ef1c693f85bbde1b95859163655211ed94149e7603aa309f164b6997a8b02202cd0e771ae9d7ff8150f4a7de68b9f3f552464b762d58b2b155e673cc3b06310"},
		signatureCase{"03e5be67da02a9ef5e65b629f90b9ce81d4070c1a02d4ed4df3e190e218a8e8e9f", "e3a8bf0703ab3e24f91bf39d90f81e3d6c1bcd4e5d03a330d7a7527cfd1a2290", "3045022100bd113e32e21819e080ac37ed2b65316770fd1bdf0eedaf5b8cc949e15b36bd4b022051f6d7d33d467e614b8487f67d8c3fbacdd7512ec32cc646f430e08da9120a70"},
		signatureCase{"02a22512b459db32bb9792f24dfc1a6fa41619ce72abe34c00f537a76d6b0c55b4", "16d8fabaef3a5807720ad1e216dbb35046ed5e683cec75eba6bc54869831fc1b", "304402205584abdcd94b9972b1105e91e200bba05afaf731f4e52f695ec5eb7e4f5427b702204f6bcff6f98614b9d3f92ab057cef1968e98bf7153166e11572949c0bf9c07e7"},
		signatureCase{"036d60186d1c00e389a6322e571a3c00be2da9a1c1e1846df11a3129aaaff5d381", "662306eeba367eb33d9dde0fb94aeef1ee7409e7fceb018cda052086abe35ec6", "3045022100aa1d7ed38c57d18fecda64700e09fcf06ef09f8427a01a87eaec955fed1918a2022075b122d2c78667ac83f76b2116203a4ab42e272564a6a9abb2c7c1708c32baae"},
		signatureCase{"02a1917b1464ab579fc1ae602b569855fd9223dab27e53e48399e6737ca6f8f6e1", "8b6bac751ea54e73327cef9c7aabe8e6d101e202a3da1e5d44bf58849d90f613", "3045022100b10a8bcd7bdd97720e1b927210fabac4c8032e783fce144f49cc26a05ac3d5f102207acb101dc831f2edb65e6e4a0dbac28a806353e2b796705974d745af90b030af"},
		signatureCase{"03940e99dee2cba1f269394e636ea42af2dfee5e71f0958ea6d4f7b440a2ab057d", "634b91e5dcd23525c532d412765d7753ca49d74d18292c0ca4353e38b074f185", "3045022100ebebd1e1d17f7f3921968de199800790046cc58b4984a0f770330dcd94dfaba90220334657fd62224bcbef969c3c8ce8dbea9ff63a66fef80b7ad1548073ce3db97c"},
		signatureCase{"02a692da123bb0d294270cad00200918c6f106c89c9f40bd9e7f3de9839970908b", "3f1c8ca5987a2f93f81365297deca894eea254fa0743cc456338ea0c023e931e", "3045022100b4daa3901a114da493417cf9753ec24fc0a0824391cfda959144e0c74927298b02205898093c6dff801864af65303480f60d8879676bbe32f00f2c58784304ba6922"},
		signatureCase{"03f6063c8832b26541397fb3e91f1eaed2bf4ed941851e8359c1d6a746a460ab8a", "e6f240884b3c6ab847d8c930df24d7eec0ec596e24ab15393b155a45d87711e3", "3045022100dc2e1a4b4983c1dc53372b2cfa9325d2bcf655bd39d9241c3c79d089789443fa0220577f49ef5c6a20ff9af29f487507d6c205f21d479d722b2b5fb7a2f2246f5b01"},
		signatureCase{"02d3f745f014dddc5374a4f4dd8777a4e9d9cf7e2fce1962788e9d6f785ef2b735", "357162601a343d75fed46c1a05d4cf9b68be1ff056d02cc6b1b3a21e6c6e8f51", "3045022100c6cef846def5f66142f535d31b86d34c7b8f182c08693abc2b090927c57c2823022026ab7ea67d0ee1a9bd5f13ed6b78818c639702955d726f010a5fd3b7d65cf688"},
		signatureCase{"03af6ccd4445683d04b42f18b6cc48b078606b8c09ca15cb0e48533770bb577aeb", "40f3a70ae28b2ad60429d4dc2d358f85045d0ec6b6a1d595c1f65a08a3fd6160", "3045022100fa5895910ddebcc62902fd3aa2246adf670e938ac9600d5c059876a7ac75cda10220054b35d0de6047ca4ac987691ec80866f65eeee9c5428a13610dd274ee0d910c"},
		signatureCase{"031600535fd518e784d1a3513a896e9f6ab92a77d6b1f1a9c9730c68fce265a010", "3c331d00caec5da7473883d00fe333e91d4c5b40b8272f99a230fa8b28cdd938", "3045022100849ff4890dced69709ce36300a48b60c19b19ec8026cf14e12865aad2196b6f602207cfb2ec656629e87962b008683e3e52d3ef062a86a2be7a3d8a182c6fed5b97f"},
		signatureCase{"022fae7d63120d4084e47c946dca2f819b111de606f382e095b678ffd8618f49ed", "8a0dd40e77e8662bd1eb3922492cf4cf2280c8ad0e72a4d3e5dbfbb90fa725a9", "3045022100b04075a5cdf175814ff9d1ca3949972b578c50853a03c728e1c6df6e3714dfb3022011934eef0c95f971535045cc149400b24b4e7c2b704e62672f47aa7eacc5c1b4"},
		signatureCase{"0360c3abf080b72e68874a29626626f035742710e2ae3c326124ddb1f7f8cddf77", "07123d3f52a077e2b57c37be9dca9cdd31ba5a51caef6e49b5ea72af7a1f1bec", "3044022067881799c7ac8603208d884be14aa8e65692897c35fc05a1527daab91aa41302022050927e9e896b23142169a43c0d9f8ea7d3d7b21bdb3c09783dc3af25d7714173"},
		signatureCase{"02f0751dbd19e4bca90415a7de8a9d254e8be211c588230c4d268672ef9f3627a8", "13f8ea99488456fbee580dc318f7dae15e0a3b072dd6012b7fee2e7cb30d31fe", "304402204c9f67c31279e18fd1a608c8a52fed0f59cd7675246ef79a425947093a6d0e4202206117126a9839eaf4c29244a616aad929b53e1138eddc3499fae7040a4227480e"},
		signatureCase{"03f554f28c0ac9e8f2cc9f36d2a7bc086952e86844b133c58647740df6a3beb5e2", "169e51bfe2b114990162bddf33595222c2246f30707570048d4b999543f8e65d", "304402207a7237e7466e5763f47f918aa315895200f8e7a57e4789b481f668abf61058fa022075bf1858cc9e068479a069f10b53fd9d6d0cb0429eee93b58f542897344e28e0"},
		signatureCase{"02e6272ee4c1dc0afce45f98fdb577d26bbe745a447a6d1961af5ecc17c00e1814", "9abe0012d0bf24bbdc73bc8175f1fae77058e60b347f33a8c90857a3c75679e6", "304502210097ac076571243179a8047f3224ac3e5f0f0369d866c8ed89c712fa94de663cc3022071b110736863f14c83c0c9b956185e38373ff2fff93d0776a717904b6b6988f0"},
		signatureCase{"0217ca4a1c8b336ac98a9d4751b5f230d0401418c2f004213044cacc7a5b472069", "133a0a1a18f13eba9172819502733c5b4642e450f770ed59c281856bb21a928f", "30450221008c9495f917d94b876bf74a88814def5462ca6b7ad49b3370da6be3433eb871fd02202fa581e293554ea91b23e167034eccf0376254043b2e68f619bab565f99f64f4"},
		signatureCase{"02425b71338d58a5db36c1041824f046915ef1df365fc05303e2a45b98e6abbcd7", "afecf7f21626432310190cdd7b1fca5cc4c4cc417e1dc2626eb185e9e789044e", "30440220058888b3605c1ddf91b14998b917ce1bc2dfffab5e8323ba7697dd16e56e433202202fcb017823b1b6f403be667c2ee84bfc6c85f6dd39b68a27793d66e000631475"},
		signatureCase{"02b3222ea974d21266a958d40c60fcf298e2b20bd70fd15a9b848b3aad5c7487ba", "71ff4f93a68b4c92c05f71b100b9ec195998c629ead8f2a6a714e9c58da01a1a", "3045022100f652e27284b400320f042bfd161c40c1e1aa9f52f1f16f398965334308ab05f702201588956a2a035f28f883943bd50dfe166852a071c3ce008e5cee3919002910db"},
		signatureCase{"03acf7f5944eca113d6879dbd5fd2f67eaac4f2a428dec725080e6529a32d5c18f", "9e551e7a336c7494ad05a737627e3bcf2338d153b0fc20a562de97fa7521fa7d", "3045022100d4de847421acf9fdb093bd912098aed51e5065caa48d54fcd590d9e15b0be1ec022042ecb131393eb4f589885821b8b1c94435caaa4eaec0cc2d2507f2b179e0173d"},
		signatureCase{"025f49426f82add17a27080267f6e603e8b96cae60a065391ff2d63b8000ce0802", "0608c2dad242a1ff4dfd43abd92e9c05973f30ecaba0f5b39aef9b94baadbc06", "3045022100f6e9f8c5e87b75cfd4fe758ff9a41b583ebadb923fb0289a6d0d0e775eb81c0902204f21cf62aa260bffb4ce408f30121c59aaa53db171a26b829b42ec75bf2ae06b"},
		signatureCase{"03665c8b1f02caa5cbb207d71d0fc75f9cea669195881069182f991b408ad3b79f", "a3abef6890c480b75a2ea8c499f176e6edb55dfe16840cbf8c2464579ed41a1a", "3045022100e457bccd584b8931a6c6a93462ac7c2312663a4a9607d625fcd7e67ea81a91cd0220148f5408d57a7163638dbe371c4dcf45a2064f9c4e8d74778914ebdaa9dd8be7"},
		signatureCase{"025cc769d0a2caf688b9b6225a26f896e5156ded538e8376149d1fde6344345894", "31f67f8d723740a6e58d6d8a6cfad9c628d80edf6407baf12fc2c02aec8c8dbe", "304402201c53518bcd57b895bb1eb43a64659cf36a2fe1cef85187c5eca28d4a9df5c3ef02206f6f023d29e20edffe4c27896e4b2ae5c411b669b1b52cfe58c9a67fd44df1b1"},
		signatureCase{"032488d99cb6459a2bc6edc739a64273496b7633263a93964adaa108666f57e49f", "8321b357113cfa87c553d00661a2c3da7e123c1ffdc4c984b48a50ae8289664d", "304402205134cbefe2188a5fb57420d793a82cf93d169912177324a4f9346c91c800af0e02207b15e68177ff5e31c2212e298cf15edb8e4056eae55da8bae5d83d4a65d5f847"},
		signatureCase{"031ac84648e1b1070a1916bc41a6aa844ada47ab5b73bc63f6e731156c4d34a4de", "d964b6be42f9412a1b1661ff9d9fd4b1fca0da73dc02cda3c3d030aedff72b61", "3045022100f3f36c74f200df390444985c616e0d7a895eaf9391d3d764fde8b032a4d47258022052b2a45d0a3657f0f643dfa8fbebda8c7394b49ecddce310bcee5a56001f0610"},
		signatureCase{"03ac05efca319ffbd1d8c6abf7af10d377fcad859b483018fd528a3fb794be19b4", "7849c122052046141cb3aaf54530409bb0fa81fa3aa8799de8709a7b48da3c64", "3045022100b6e5d54c3f09fce8d22fa1f5e8acb741b3f1e14142a99ea05126a9ea6abf278f02206ae5bd6ceee0a1c1bb7b1f0ea16e545f0de065c77ce20497d33cf85820a286d1"},
		signatureCase{"032a20d82e51b0b0e929c1c61ffd24887a1d03b63209114d0bdc166df3da51ab04", "48e6c9f749fec5bc70bca67c8513a68f993f6904cda9fbecdddd84f21c05534a", "3045022100eb0f04a78b34a519f7bb1427d79ad962f8aa7d78b6aaab59f8fbc0064c22c6a2022054d7473e26b0ef6ce5908245b58c88bad4ac8c521d3d2b5b17d06631588791eb"},
		signatureCase{"03bddf002e595b74d5a8f38187441c630382f73bd4011f3b775dc296b741057950", "b6433c3d03313b46e4836ae084c40a839d6ac9e57161e804f6253820266df4b5", "30440220445e6d89fe3f0a20b19651a4891ddb5d74f3eba90d49d384270db16021a6e5d60220315fff420424da21e9919e0458f6a15e2f0e06a08050d3a201790034853002db"},
		signatureCase{"03bdbc60288dd5e3ee59dd9b72d8ce09faf9324543a8ddcd046ec4d075c73cd497", "903cfb72827a0623d2cab1dfe7ba7807daad0eec525c34db6b6db3d15aacd9d4", "3044022011f45a7428c89b452086815e8318b7299367b9cb415482c2a5a976b9ba04cdb1022050520a12f2cac27dd9ee44542863abcb2dae12b0073e773a8f338309ed43a4a3"},
		signatureCase{"02f42f59f175c418547736aa5e6456f5c91238a45813391d71a3817bf50f06fce1", "9b4c5630cc37a611e8a434e7ca84ea2648a435cef0a9b589398066b53677b7cb", "3045022100ac4d458aaee090b55901581897a747a1c3bfa5112f4752a317be776629e76694022055c181faeb0d484f6787f13516054ba3bff23fc45406bbd625ddba730a512945"},
	}

	t.Run("test verify with java result", func(t *testing.T) {
		for _, item := range sigCases {
			data, err := hex.DecodeString(item.dataHex)
			assert.IsNil(t, err, "hex-decode")
			pubBytes, err := hex.DecodeString(item.pubhex)
			assert.IsNil(t, err, "pub-decode")
			_eckey, err := FromPubKeyBytes(pubBytes)
			assert.IsNil(t, err, "FromPubKey")
			result, err := hex.DecodeString(item.sigHex)
			assert.IsNil(t, err, "sig-decode")
			val := _eckey.Verify(data, result)
			if !val {
				t.Fatalf("Verify signature failed.")
			}
		}
	})
	t.Run("test wrong sig", func(t *testing.T) {
		item := signatureCase{"02425b71338d58a5db36c1041824f046915ef1df365fc05303e2a45b98e6abbcd7", "9b4c5630cc37a611e8a434e7ca84ea2648a435cef0a9b589398066b53677b7cb", "3045022100ac4d458aaee090b55901581897a747a1c3bfa5112f4752a317be776629e76694022055c181faeb0d484f6787f13516054ba3bff23fc45406bbd625ddba730a512945"}
		data, err := hex.DecodeString(item.dataHex)
		assert.IsNil(t, err, "hex-decode")
		pubBytes, err := hex.DecodeString(item.pubhex)
		assert.IsNil(t, err, "pub-decode")
		_eckey, err := FromPubKeyBytes(pubBytes)
		assert.IsNil(t, err, "FromPubKey")
		result, err := hex.DecodeString(item.sigHex)
		assert.IsNil(t, err, "sig-decode")
		val := _eckey.Verify(data, result)
		if val {
			t.Fatalf("Verify signature failed.")
		}
	})
}

func TestCipher(t *testing.T) {
	eckey, _ := NewEcKey()
	dataHex := "230cb8ebbf3a2c581d27f98f7a38f8b07c1ff170d605ca645db4ffa05ffa5505"
	data, _ := hex.DecodeString(dataHex)
	result := eckey.Encrypt(data)
	_data := eckey.Decrypt(result)
	assert.IsDeepEquals(t, data, _data)
}

type eckeyCase struct {
	prikey string
	pubkey string
}

type signatureCase struct {
	pubhex  string
	dataHex string
	sigHex  string
}

func BenchmarkCheckNewEcKey(b *testing.B) {
	for i := 0; i < b.N; i++ {
		NewEcKey()
	}
}
